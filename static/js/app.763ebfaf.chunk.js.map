{"version":3,"sources":["assets/image-loading.png","components/Text.tsx","utils.ts","components/PlayerControls.tsx","components/Player.tsx","hooks/useToast.tsx","hooks/usePlayer.tsx","components/SongDisplay.tsx","components/SongListItem.tsx","components/SongListing.tsx","views/QueueView.tsx","components/CollectionListItem.tsx","components/CollectionListing.tsx","components/CollectionFetcher.tsx","hooks/useFetchCollectionsByAddress.tsx","hooks/useFetchCollectionsByName.tsx","components/SearchInput.tsx","hooks/useFetchMusicNfts.tsx","components/SongPaginator.tsx","components/SongFetcher.tsx","components/WelcomeMessage.tsx","views/SearchView.tsx","views/SongInfoView.tsx","App.tsx","hooks/useQueue.tsx","hooks/useSearch.ts"],"names":["module","exports","Text","props","style","color","children","isAddressLike","maybeAddress","test","isEnsLike","maybeEns","endsWith","formatMs","millis","minutes","Math","floor","seconds","parseFloat","toFixed","TrackSlider","backgroundColor","minimumTrackTintColor","maximumTrackTintColor","thumbTintColor","minimumValue","maximumValue","endMs","value","curMs","tapToSeek","onSlidingStart","onSlidingComplete","PlayerControls","useState","setCurMs","setEndMs","isSliding","setIsSliding","useEffect","status","playerState","soundStatus","duration","durationMillis","isNaN","positionMillis","nowPlaying","currentLoadedSong","song","collectionName","name","View","width","styles","sliderView","a","async","sound","setPositionAsync","TouchableOpacity","onPress","onChangeIsPlayerOpen","disabled","isLoading","container","view","alignItems","paddingLeft","fontSize","numberOfLines","ellipsizeMode","paddingRight","controlsView","setIsLooping","isLooping","paddingTop","Platform","OS","lineHeight","handlePlayPreviousSong","setIsPlaying","isPlaying","handlePlayNextSong","handleToggleQueueView","StyleSheet","create","marginTop","marginLeft","marginRight","justifyContent","flexDirection","Player","playAsync","playSound","pauseAsync","pauseSong","onChangeIsSongInfoViewOpen","useToast","showToast","setShowToast","message","setMessage","toastType","setToastType","setDuration","toast","Toast","show","shadow","containerStyle","borderRadius","borderTopColor","borderTopWidth","position","animation","hideOnPress","textColor","setTimeout","hide","displayToast","toastMessage","durationMs","fetchSoundWithTimeout","audioUri","timeoutMs","Promise","resolve","reject","Audio","Sound","createAsync","uri","then","SongDisplay","Image","defaultSource","imageLoading","source","imageUri","height","SongListItem","onChangeSong","buttons","addToUserQueue","removeFromQueue","padding","SongListing","FlatList","data","songs","renderItem","item","index","onChangeCurrentSong","undefined","keyExtractor","idx","collectionAddress","tokenId","ListFooterComponent","hasNextPage","length","loadMoreButton","QueueView","SafeAreaView","safeAreaView","handleCloseQueueView","marginBottom","queueState","userQueue","songIdx","handleSetCurrentSong","removeFromUserQueue","globalQueue","removeFromGlobalQueue","flex","CollectionListItem","onChangeCollection","collection","CollectionListing","collections","CollectionFetcher","query","shouldPerformQuery","useQuery","gql","variables","collectionAddresses","skip","loading","error","nodes","map","res","address","description","useFetchCollectionsByAddress","submitted","queriedCollectionsLoading","queriedCollectionsError","queriedCollections","search","useFetchCollectionsByName","shouldSearchCollectionsByName","searchedCollectionsLoading","searchedCollectionsError","searchedCollections","onChangeSelectedCollection","SearchInput","searchInputBackground","Feather","size","TextInput","textInput","autoCorrect","autoComplete","autoCapitalize","placeholder","placeholderText","returnKeyType","onSubmitEditing","onChangeSubmittedText","text","onChangeText","Keyboard","dismiss","cancelButton","margin","borderWidth","borderColor","TokenFragment","MusicNFTSearchQuery","useFetchMusicNfts","ownerAddress","sort","limit","ownerAddresses","tokens","token","owner","content","mediaEncoding","original","image","thumbnail","metadata","SongPaginator","currentPage","setCurrentPage","slice","offset","setOffset","curOffset","loadMoreText","SongFetcher","musicNfts","searchLoadingText","noneFoundText","onChangeSelectedSong","startIdx","indexOf","nextSongs","prevSongs","endIdx","min","i","includes","push","handleChangeGlobalQueue","WelcomeMessage","sortKey","sortDirection","SearchView","searchState","onChangeQuery","onChangeSubmitted","selectedCollection","setSelectedCollection","shouldQueryByOwner","searchInputContainer","fetcherContainer","setGlobalQueue","SongInfoView","showMetadata","setShowMetadata","handleCloseSongInfoView","ScrollView","header","showMetadataButton","showMetadataText","JSON","stringify","maxWidth","paddingBottom","client","ApolloClient","cache","InMemoryCache","App","history","setHistory","setUserQueue","addToHistory","curHistory","popFromHistory","curUserQueue","filter","s","popFromUserQueue","curGlobalQueue","popFromGlobalQueue","useQueue","setCurrentLoadedSong","setSoundStatus","songJustFinished","setSongJustFinished","setIsLoading","didSuccessfullySetSong","setOnPlaybackStatusUpdate","didJustFinish","replayCurrentSong","unloadAsync","playPreviousSong","getStatusAsync","usePlayer","isQueueViewOpen","setIsQueueViewOpen","isSongInfoViewOpen","setIsSongInfoViewOpen","hasSetAudioMode","setHasSetAudioMode","setQuery","setSubmitted","toLowerCase","trim","useSearch","setAudioModeAsync","staysActiveInBackground","interruptionModeIOS","InterruptionModeIOS","DoNotMix","allowsRecordingIOS","playsInSilentModeIOS","ApolloProvider","StatusBar","screen","player","shadowColor","shadowOffset","borderLeftWidth","borderRightWidth","borderTopLeftRadius","borderTopRightRadius","shadowOpacity","shadowRadius"],"mappings":"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","file":"static/js/app.763ebfaf.chunk.js","sourcesContent":["module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAARMAAAC3CAMAAAAGjUrGAAAAM1BMVEXExMT////BwcHo6Oju7u7Y2Nj5+fn09PTJycn8/PzPz8/GxsbU1NTMzMzl5eXp6enf3984nfntAAADJ0lEQVR4nO3cjZKaMBRAYYiIIL/v/7SLii6SEEGJeC/n60yn0+q4OcUAUYgiAAAAAAAAAAAAAAAAAAAAAAAA4OcZU1VZIFVhzNbjW84UzSkOJ0/arUe4mDnmAYtcpWdZm4o5hi7Syc9bD3MJU34hSRcl23qgS4ScSgaSrcc531feOVfl1kOdrbhvJskhkKR/gaOYabZIbz9xbYJphDY5hXuF+7uTJv9oYqOJTVGT1U7ctDQporJts6JY4xVUNDFZk1/+Nk9P5QrjMK38Jk+nycnnpykKtpP7f2sv/TiK/CajJN2/fBpFfBPHysGnu2nxTVwrB9VnryC+ydlOEjefDUZ6E3NwNElfHqZ4Ryu+iXPR7eVq0MG3BC2+SfJOkzrOPVF22aSOY18U8U3eeO/cpqDpKOKbuFasvXPsY1aejCK9SeT6sMe3Lx7sqKaiiG/iOmbzfYTXDB43EUV+E/ugrfY8u3l6pDuK/CbXvciQ7/O7ZvRYZxQFTUZRkumzHceO2xVFQ5OoHKwp1Z5jMdexjCOKiiYmK28zbVpnnnE4D++6GXn8FBVNLud0VZF1vzwbyTl1J7G3FCVNXppO0kUZLWzvpImpppNYUfbRxFQvvgD3FGUXTV4meY6yhya+ueRhEEBfE/twY06S4YGNuiamHe9F5iUZnCZpa2Lq8YTp3eM8OfTPU9bEXM99BlFmTK9WFGVN+tPBR5RFSe5ziqom5nGG3EeZPZf0EnVNzGDR4BplaRJ9TczTOkoXZXESdU3MaL2tXDiXKGwyThLH4++l7K+JleQdqpo4v16w7ybZxLLijptkS/cv+puslkRPk/knebtpUq14eaCSJituJVqauL+nRBOa0MRGExtNbDSx0cRGExtNbDSxjZo0aXq6SB+/vf/HVOHnOyuhiY0mNprY5DYJ9wOLbRKfw907SN79Cvq1xjQJJpfWxLoWP5hWTJMoC36zx5vXVyn/DvvT8jDk3LLuYnxlUhC+q8V+0ReiSEsSRcdVT4dtibDbx14YkxVtE+Z2j01b+K6M+mnhjtm2HhkAAAAAAAAAAAAAAAAAAAAAAAAAAN/0B81WMJZb1X1AAAAAAElFTkSuQmCC\"","import { Text as ReactNativeText, TextProps } from \"react-native\";\n\nexport default function Text(props: TextProps): JSX.Element {\n  return (\n    <ReactNativeText {...props} style={[{ color: \"white\" }, props.style]}>\n      {props.children}\n    </ReactNativeText>\n  );\n}\n","export const normalizeText = (text: string): string => {\n  return text.toLowerCase().trim();\n};\n\nexport const isAddressLike = (maybeAddress: string): boolean => {\n  if (!/^(0x)?[0-9a-f]{40}$/i.test(maybeAddress)) {\n    return false;\n  } else {\n    return true;\n  }\n};\n\nexport const isEnsLike = (maybeEns: string): boolean => {\n  return maybeEns.endsWith(\".eth\");\n};\n\nexport const formatMs = (millis: number): string => {\n  const minutes = Math.floor(millis / 60000);\n  const seconds = parseFloat(((millis % 60000) / 1000).toFixed(0));\n  return seconds == 60\n    ? minutes + 1 + \":00\"\n    : minutes + \":\" + (seconds < 10 ? \"0\" : \"\") + seconds;\n};\n","import { AVPlaybackStatusSuccess } from \"expo-av\";\nimport { useEffect, useState } from \"react\";\nimport { Platform, StyleSheet, TouchableOpacity, View } from \"react-native\";\nimport Slider from \"@react-native-community/slider\";\nimport { PlayerState } from \"../hooks/usePlayer\";\nimport Text from \"./Text\";\nimport { formatMs } from \"../utils\";\n\nfunction TrackSlider(props: {\n  curMs: number;\n  endMs: number;\n  onSlidingStart: () => void;\n  onSlidingComplete: (value: number) => void;\n}): JSX.Element {\n  return (\n    <Slider\n      style={{ backgroundColor: \"rgba(255,255,255,0)\" }}\n      minimumTrackTintColor=\"#5c5c5c00\"\n      maximumTrackTintColor=\"#5c5c5c00\"\n      thumbTintColor=\"#5c5c5c\"\n      minimumValue={0}\n      maximumValue={props.endMs}\n      value={props.curMs}\n      tapToSeek={true}\n      onSlidingStart={props.onSlidingStart}\n      onSlidingComplete={props.onSlidingComplete}\n    />\n  );\n}\n\ninterface PlayerControlProps {\n  playerState: PlayerState;\n  onChangeIsPlayerOpen: () => void;\n  handleToggleQueueView: () => void;\n}\n\nexport default function PlayerControls(props: PlayerControlProps): JSX.Element {\n  const [curMs, setCurMs] = useState(0);\n  const [endMs, setEndMs] = useState(1);\n  const [isSliding, setIsSliding] = useState(false);\n\n  useEffect(() => {\n    const status = props.playerState.soundStatus as AVPlaybackStatusSuccess;\n    if (status != null && !isSliding) {\n      const duration =\n        status.durationMillis != null && !isNaN(status.durationMillis)\n          ? status.durationMillis\n          : 1;\n      setCurMs(status.positionMillis);\n      setEndMs(duration);\n    }\n  }, [props.playerState.soundStatus, setCurMs, setEndMs, isSliding]);\n\n  const nowPlaying = props.playerState.currentLoadedSong\n    ? `${props.playerState.currentLoadedSong.song.collectionName}: ${props.playerState.currentLoadedSong.song.name}`\n    : \"~ vibing to silence ~\";\n  return (\n    <View style={{ width: \"100%\" }}>\n      <View style={styles.sliderView}>\n        <TrackSlider\n          curMs={curMs}\n          endMs={endMs}\n          onSlidingStart={() => setIsSliding(true)}\n          onSlidingComplete={async (value: number) => {\n            await props.playerState.currentLoadedSong?.sound.setPositionAsync(\n              value\n            );\n            setIsSliding(false);\n          }}\n        />\n      </View>\n      <View>\n        <TouchableOpacity\n          onPress={() => {\n            if (props.playerState.currentLoadedSong != null) {\n              props.onChangeIsPlayerOpen();\n            }\n          }}\n          disabled={\n            props.playerState.currentLoadedSong == null ||\n            props.playerState.isLoading\n          }\n          style={styles.container}\n        >\n          <View style={styles.view}>\n            <View style={{ alignItems: \"center\", paddingLeft: 10 }}>\n              <Text style={{ fontSize: 12 }} numberOfLines={1}>\n                {formatMs(curMs)}\n              </Text>\n            </View>\n            <View style={{ width: 240, alignItems: \"center\" }}>\n              <Text\n                style={{ fontSize: 16 }}\n                numberOfLines={1}\n                ellipsizeMode=\"tail\"\n              >\n                {nowPlaying}\n              </Text>\n            </View>\n            <View style={{ alignItems: \"center\", paddingRight: 10 }}>\n              <Text style={{ fontSize: 12 }} numberOfLines={1}>\n                {formatMs(endMs - curMs)}\n              </Text>\n            </View>\n          </View>\n          <View style={styles.controlsView}>\n            <TouchableOpacity\n              onPress={() =>\n                props.playerState.setIsLooping(!props.playerState.isLooping)\n              }\n              style={{ paddingTop: 4, paddingLeft: 12, paddingRight: 12 }}\n            >\n              <Text\n                style={{\n                  fontSize: Platform.OS === \"web\" ? 24 : 42,\n                  lineHeight: Platform.OS === \"web\" ? 48 : 48,\n                  color: props.playerState.isLooping ? \"#9B59B6\" : \"white\",\n                }}\n              >\n                ⟳\n              </Text>\n            </TouchableOpacity>\n            <TouchableOpacity\n              onPress={() => props.playerState.handlePlayPreviousSong()}\n              disabled={props.playerState.isLoading}\n            >\n              <Text style={{ fontSize: 48 }}>🌜</Text>\n            </TouchableOpacity>\n            <TouchableOpacity\n              onPress={() => {\n                if (props.playerState.currentLoadedSong != null) {\n                  props.playerState.setIsPlaying(!props.playerState.isPlaying);\n                }\n              }}\n              disabled={props.playerState.currentLoadedSong == null}\n            >\n              {props.playerState.isPlaying ? (\n                <Text style={{ fontSize: 48 }}>🌝</Text>\n              ) : (\n                <Text style={{ fontSize: 48 }}>🌞</Text>\n              )}\n            </TouchableOpacity>\n            <TouchableOpacity\n              onPress={() => props.playerState.handlePlayNextSong()}\n              disabled={props.playerState.isLoading}\n            >\n              <Text style={{ fontSize: 48 }}>🌛</Text>\n            </TouchableOpacity>\n            <TouchableOpacity\n              onPress={props.handleToggleQueueView}\n              style={{ paddingLeft: 12, paddingRight: 12 }}\n            >\n              <Text\n                style={{\n                  fontSize: 32,\n                  lineHeight: 48,\n                }}\n              >\n                ≡\n              </Text>\n            </TouchableOpacity>\n          </View>\n        </TouchableOpacity>\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  sliderView: {\n    marginTop: Platform.OS === \"web\" ? -10 : -20,\n    marginLeft: 10,\n    marginRight: 10,\n  },\n  container: {\n    width: \"100%\",\n    alignItems: \"center\",\n    justifyContent: \"flex-end\",\n  },\n  view: {\n    width: \"100%\",\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n  },\n  controlsView: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    width: \"100%\",\n    paddingTop: 30,\n    paddingLeft: \"10%\",\n    paddingRight: \"10%\",\n  },\n});\n","import { Sound } from \"expo-av/build/Audio\";\nimport { useEffect } from \"react\";\nimport { View } from \"react-native\";\nimport { PlayerState } from \"../hooks/usePlayer\";\nimport PlayerControls from \"./PlayerControls\";\n\nconst playSound = async (sound: Sound | null) => {\n  if (sound != null) {\n    await sound.playAsync();\n  }\n};\n\nconst pauseSong = async (sound: Sound | null) => {\n  if (sound != null) {\n    await sound.pauseAsync();\n  }\n};\n\ninterface PlayerProps {\n  playerState: PlayerState;\n  onChangeIsSongInfoViewOpen: () => void;\n  handleToggleQueueView: () => void;\n}\n\nexport default function Player(props: PlayerProps): JSX.Element {\n  const sound = props.playerState.currentLoadedSong?.sound;\n\n  useEffect(() => {\n    if (sound != null) {\n      if (props.playerState.isPlaying) {\n        playSound(sound);\n      } else {\n        pauseSong(sound);\n      }\n    }\n  }, [props.playerState.isPlaying, sound]);\n  return (\n    <View\n      style={{\n        width: \"100%\",\n      }}\n    >\n      <PlayerControls\n        playerState={props.playerState}\n        onChangeIsPlayerOpen={props.onChangeIsSongInfoViewOpen}\n        handleToggleQueueView={props.handleToggleQueueView}\n      />\n    </View>\n  );\n}\n","import { useEffect, useState } from \"react\";\nimport Toast from \"react-native-root-toast\";\n\ntype ToastType = \"success\" | \"error\";\n\nexport interface ToastState {\n  displayToast: (message: string, type: ToastType, durationMs?: number) => void;\n}\n\nexport function useToast(): ToastState {\n  const [showToast, setShowToast] = useState(false);\n  const [message, setMessage] = useState<string | null>(null);\n  const [toastType, setToastType] = useState<ToastType | null>(null);\n  const [duration, setDuration] = useState<number | null>(null);\n\n  const displayToast = (\n    toastMessage: string,\n    toastType: ToastType,\n    durationMs?: number\n  ) => {\n    setMessage(toastMessage);\n    setShowToast(true);\n    setToastType(toastType);\n    if (durationMs != null) {\n      setDuration(durationMs);\n    }\n  };\n\n  useEffect(() => {\n    if (showToast && message != null && toastType != null) {\n      let toast = Toast.show(message, {\n        shadow: false,\n        backgroundColor: \"white\",\n        containerStyle: {\n          width: \"100%\",\n          borderRadius: 10,\n          borderTopColor: toastType === \"success\" ? \"limegreen\" : \"red\",\n          borderTopWidth: 8,\n        },\n        position: -200,\n        animation: true,\n        hideOnPress: true,\n        textColor: \"#2d2d2d\",\n      });\n\n      setTimeout(() => {\n        Toast.hide(toast);\n        setShowToast(false);\n      }, duration ?? 700);\n    }\n  }, [showToast, message, toastType, duration]);\n\n  return {\n    displayToast,\n  };\n}\n","import { Sound } from \"expo-av/build/Audio\";\nimport { Audio, AVPlaybackStatus, AVPlaybackStatusSuccess } from \"expo-av\";\nimport { useEffect, useState } from \"react\";\nimport { Token } from \"../models/token\";\nimport { useToast } from \"./useToast\";\nimport useQueue, { QueueState } from \"./useQueue\";\n\nexport interface LoadedSong {\n  song: Token;\n  sound: Sound;\n}\n\nexport interface PlayerState {\n  handlePlayPreviousSong: () => void;\n  handlePlayNextSong: () => void;\n  currentLoadedSong: LoadedSong | null;\n  handleSetCurrentSong: (song: Token | null) => Promise<boolean>;\n  isPlaying: boolean;\n  setIsPlaying: (isPlaying: boolean) => void;\n  soundStatus: AVPlaybackStatus | null;\n  isLooping: boolean;\n  setIsLooping: (isLooping: boolean) => void;\n  isLoading: boolean;\n}\n\nfunction fetchSoundWithTimeout(\n  audioUri: string,\n  timeoutMs: number\n): Promise<{ sound: Sound; status: AVPlaybackStatus }> {\n  return new Promise(function (resolve, reject) {\n    Audio.Sound.createAsync({\n      uri: audioUri,\n    }).then(resolve, reject);\n    setTimeout(reject, timeoutMs);\n  });\n}\n\nexport function usePlayer(queueState: QueueState): PlayerState {\n  const { displayToast } = useToast();\n  const [currentLoadedSong, setCurrentLoadedSong] = useState<LoadedSong | null>(\n    null\n  );\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [soundStatus, setSoundStatus] = useState<AVPlaybackStatus | null>(null);\n  const [songJustFinished, setSongJustFinished] = useState(false);\n  const [isLooping, setIsLooping] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n  // const { addToHistory, popFromHistory, popFromUserQueue, popFromGlobalQueue } =\n  // useQueue();\n\n  // Playback\n  const handleSetCurrentSong = async (song: Token | null): Promise<boolean> => {\n    let didSuccessfullySetSong = false;\n\n    if (song != null && song.audioUri != null && !isLoading) {\n      try {\n        setIsLoading(true);\n        const { sound } = await fetchSoundWithTimeout(song.audioUri, 3000);\n        if (sound != null) {\n          setCurrentLoadedSong({ song: song, sound: sound });\n          didSuccessfullySetSong = true;\n          setIsPlaying(true);\n          sound.setOnPlaybackStatusUpdate((status: AVPlaybackStatus) => {\n            setSoundStatus(status);\n            if ((status as AVPlaybackStatusSuccess).didJustFinish === true) {\n              setSongJustFinished(true);\n            }\n          });\n        }\n      } catch (e) {\n        displayToast(\n          `audio encoding for ${song.name} in progress`,\n          \"error\",\n          2000\n        );\n      } finally {\n        setIsLoading(false);\n      }\n    }\n    return didSuccessfullySetSong;\n  };\n\n  const handlePlayPreviousSong = async () => {\n    const playPreviousSong = () => {\n      const song = queueState.popFromHistory();\n      if (song != null) {\n        handleSetCurrentSong(song);\n      } else {\n        replayCurrentSong();\n      }\n    };\n\n    if (currentLoadedSong != null) {\n      const status = await currentLoadedSong.sound.getStatusAsync();\n      const positionMs = (status as AVPlaybackStatusSuccess).positionMillis;\n      if (positionMs > 2500) {\n        replayCurrentSong();\n        return;\n      }\n    }\n    playPreviousSong();\n  };\n\n  const handlePlayNextSong = () => {\n    if (currentLoadedSong != null) {\n      queueState.addToHistory(currentLoadedSong.song);\n    }\n    const song =\n      queueState.popFromUserQueue() ?? queueState.popFromGlobalQueue();\n    if (song != null) {\n      handleSetCurrentSong(song);\n    }\n  };\n\n  const replayCurrentSong = () => {\n    if (currentLoadedSong != null) {\n      handleSetCurrentSong(currentLoadedSong.song);\n    }\n  };\n\n  useEffect(() => {\n    if (songJustFinished) {\n      if (isLooping) {\n        replayCurrentSong();\n      } else {\n        handlePlayNextSong();\n      }\n      setSongJustFinished(false);\n    }\n  }, [songJustFinished, setSongJustFinished]);\n\n  useEffect(() => {\n    if (currentLoadedSong?.sound != null) {\n      return () => {\n        currentLoadedSong.sound.unloadAsync();\n      };\n    }\n  }, [currentLoadedSong?.sound]);\n  return {\n    handlePlayPreviousSong,\n    handlePlayNextSong,\n    currentLoadedSong,\n    handleSetCurrentSong,\n    isPlaying,\n    setIsPlaying,\n    soundStatus,\n    isLooping,\n    setIsLooping,\n    isLoading,\n  };\n}\n","import imageLoading from \"../assets/image-loading.png\";\nimport { Image, View } from \"react-native\";\nimport { Token } from \"../models/token\";\nimport Text from \"./Text\";\n\nexport default function SongDisplay(props: { song: Token }): JSX.Element {\n  return (\n    <View\n      style={{ flexDirection: \"row\", justifyContent: \"flex-start\", width: 220 }}\n    >\n      <View style={{ marginRight: 10 }}>\n        <Image\n          defaultSource={imageLoading}\n          source={{ uri: props.song.imageUri }}\n          style={{ height: 33, width: 33, borderRadius: 4 }}\n        />\n      </View>\n      <View>\n        <Text style={{ fontSize: 14 }} ellipsizeMode=\"tail\" numberOfLines={1}>\n          {props.song.name ?? \"untitled\"}\n        </Text>\n        <Text\n          style={{ fontSize: 14, color: \"gray\" }}\n          ellipsizeMode=\"tail\"\n          numberOfLines={1}\n        >\n          {props.song.collectionName ?? \"unknown collection\"}\n        </Text>\n      </View>\n    </View>\n  );\n}\n","import { Platform, StyleSheet, TouchableOpacity, View } from \"react-native\";\nimport { useToast } from \"../hooks/useToast\";\nimport { Token } from \"../models/token\";\nimport SongDisplay from \"./SongDisplay\";\nimport Text from \"./Text\";\n\ninterface SongListItemProps {\n  isLoading: boolean;\n  song: Token;\n  onChangeSong: () => void;\n  addToUserQueue: (song: Token) => void;\n  removeFromQueue?: () => void;\n}\n\nexport default function SongListItem(props: SongListItemProps): JSX.Element {\n  const { displayToast } = useToast();\n  return (\n    <TouchableOpacity\n      style={styles.container}\n      onPress={() => {\n        if (!props.isLoading) {\n          props.onChangeSong();\n        }\n      }}\n      disabled={props.isLoading}\n    >\n      <SongDisplay song={props.song} />\n      <View style={styles.buttons}>\n        <TouchableOpacity\n          onPress={() => {\n            props.addToUserQueue(props.song);\n            displayToast(\"added to queue\", \"success\");\n          }}\n          style={{ marginRight: 20 }}\n        >\n          <Text style={{ fontSize: 24 }}>＋</Text>\n        </TouchableOpacity>\n        {props.removeFromQueue != null && (\n          <TouchableOpacity\n            style={{ paddingTop: Platform.OS === \"web\" ? 2 : 6 }}\n            onPress={() => {\n              props.removeFromQueue!();\n            }}\n          >\n            <Text style={{ fontSize: 20 }}>✕</Text>\n          </TouchableOpacity>\n        )}\n      </View>\n    </TouchableOpacity>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    padding: 16,\n    alignItems: \"center\",\n  },\n  buttons: {\n    flexDirection: \"row\",\n    justifyContent: \"flex-end\",\n    height: \"100%\",\n    alignItems: \"flex-start\",\n  },\n});\n","import { FlatList } from \"react-native\";\nimport { Token } from \"../models/token\";\nimport SongListItem from \"./SongListItem\";\n\ninterface SongListingProps {\n  songs: Array<Token>;\n  onChangeCurrentSong: (songIdx: number) => void;\n  addToUserQueue: (songIdx: number) => void;\n  removeFromQueue?: (songIdx: number) => void;\n  hasNextPage?: boolean;\n  loadMoreButton?: JSX.Element;\n  isLoading: boolean;\n}\n\nexport default function SongListing(props: SongListingProps): JSX.Element {\n  return (\n    <FlatList\n      data={props.songs}\n      renderItem={({ item, index }) => (\n        <SongListItem\n          isLoading={props.isLoading}\n          song={item}\n          onChangeSong={() => props.onChangeCurrentSong(index)}\n          addToUserQueue={() => props.addToUserQueue(index)}\n          removeFromQueue={\n            props.removeFromQueue != null\n              ? () => props.removeFromQueue!(index)\n              : undefined\n          }\n        />\n      )}\n      keyExtractor={(song: Token, idx: number) =>\n        `${song.collectionAddress}-${song.tokenId}-${idx}`\n      }\n      ListFooterComponent={\n        props.hasNextPage === true && props.songs.length > 0\n          ? props.loadMoreButton\n          : undefined\n      }\n    />\n  );\n}\n","import SongListing from \"../components/SongListing\";\nimport { SafeAreaView, StyleSheet, TouchableOpacity, View } from \"react-native\";\nimport { PlayerState } from \"../hooks/usePlayer\";\nimport SongDisplay from \"../components/SongDisplay\";\nimport Text from \"../components/Text\";\nimport { QueueState } from \"../hooks/useQueue\";\n\ninterface QueueViewProps {\n  playerState: PlayerState;\n  queueState: QueueState;\n  handleCloseQueueView: () => void;\n}\n\nexport default function QueueView(props: QueueViewProps): JSX.Element {\n  const handleAddToUserQueueFromGlobalQueue = (songIdx: number) => {\n    const song = props.queueState.globalQueue[songIdx];\n    props.queueState.addToUserQueue(song);\n    props.queueState.removeFromGlobalQueue(songIdx);\n  };\n  const song = props.playerState.currentLoadedSong?.song;\n  return (\n    <View style={styles.container}>\n      <SafeAreaView style={styles.safeAreaView}>\n        <TouchableOpacity\n          onPress={() => props.handleCloseQueueView()}\n          style={{ marginBottom: 24, paddingLeft: 16, marginTop: 10 }}\n        >\n          <Text style={{ fontSize: 24 }}>✕</Text>\n        </TouchableOpacity>\n        <Text style={{ fontSize: 18, paddingLeft: 16 }}>now playing</Text>\n\n        {song && (\n          <View style={{ padding: 16 }}>\n            <SongDisplay song={song} />\n          </View>\n        )}\n        {props.queueState.userQueue.length > 0 && (\n          <View>\n            <Text style={{ fontSize: 18, paddingLeft: 16 }}>up next</Text>\n            <SongListing\n              songs={props.queueState.userQueue}\n              onChangeCurrentSong={async (songIdx: number) => {\n                const song = props.queueState.userQueue[songIdx];\n                const didSetSong = await props.playerState.handleSetCurrentSong(\n                  song\n                );\n                if (didSetSong) {\n                  props.queueState.removeFromUserQueue(songIdx);\n                }\n              }}\n              addToUserQueue={(songIdx: number) =>\n                props.queueState.addToUserQueue(\n                  props.queueState.userQueue[songIdx]\n                )\n              }\n              removeFromQueue={props.queueState.removeFromUserQueue}\n              isLoading={props.playerState.isLoading}\n            />\n          </View>\n        )}\n        {props.playerState.currentLoadedSong?.song != null &&\n          props.queueState.globalQueue.length > 0 && (\n            <View>\n              <Text style={{ fontSize: 18, paddingLeft: 16 }}>similar</Text>\n              <SongListing\n                songs={props.queueState.globalQueue}\n                onChangeCurrentSong={async (songIdx: number) => {\n                  const song = props.queueState.globalQueue[songIdx];\n                  const didSetSong =\n                    await props.playerState.handleSetCurrentSong(song);\n                  if (didSetSong) {\n                    props.queueState.removeFromGlobalQueue(songIdx);\n                  }\n                }}\n                addToUserQueue={handleAddToUserQueueFromGlobalQueue}\n                removeFromQueue={props.queueState.removeFromGlobalQueue}\n                isLoading={props.playerState.isLoading}\n              />\n            </View>\n          )}\n      </SafeAreaView>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: { width: \"100%\", alignItems: \"center\", flex: 1, height: \"100%\" },\n  safeAreaView: {\n    flex: 1,\n    width: \"100%\",\n    marginTop: 20,\n  },\n});\n","import { Collection } from \"../models/collection\";\nimport { StyleSheet, TouchableOpacity, View } from \"react-native\";\nimport SongDisplay from \"./SongDisplay\";\nimport Text from \"./Text\";\n\ninterface CollectionListItemProps {\n  collection: Collection;\n  onChangeCollection: (collection: Collection | null) => void;\n}\n\nexport default function CollectionListItem(\n  props: CollectionListItemProps\n): JSX.Element {\n  return (\n    <TouchableOpacity\n      style={styles.container}\n      onPress={() => {\n        props.onChangeCollection(props.collection);\n      }}\n    >\n      <View style={styles.view}>\n        <View>\n          <Text style={{ fontSize: 18 }} ellipsizeMode=\"tail\" numberOfLines={1}>\n            {props.collection.name ?? \"untitled\"}\n          </Text>\n        </View>\n      </View>\n    </TouchableOpacity>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flexDirection: \"row\",\n    justifyContent: \"space-between\",\n    padding: 16,\n    alignItems: \"center\",\n  },\n  view: {\n    flexDirection: \"row\",\n    justifyContent: \"flex-start\",\n    width: \"90%\",\n  },\n});\n","import { FlatList, SafeAreaView } from \"react-native\";\nimport { Collection } from \"../models/collection\";\nimport CollectionListItem from \"./CollectionListItem\";\n\ninterface CollectionListingProps {\n  collections: Array<Collection>;\n  onChangeCollection: (collection: Collection | null) => void;\n}\n\nexport default function CollectionListing(\n  props: CollectionListingProps\n): JSX.Element {\n  return (\n    <SafeAreaView>\n      <FlatList\n        data={props.collections}\n        renderItem={({ item }) => (\n          <CollectionListItem\n            collection={item}\n            onChangeCollection={props.onChangeCollection}\n          />\n        )}\n        keyExtractor={(collection: Collection) => collection.collectionAddress}\n      />\n    </SafeAreaView>\n  );\n}\n","import { View } from \"react-native\";\nimport { useFetchCollectionsByAddress } from \"../hooks/useFetchCollectionsByAddress\";\nimport { useFetchCollectionsByName } from \"../hooks/useFetchCollectionsByName\";\nimport { Collection } from \"../models/collection\";\nimport { isAddressLike, isEnsLike } from \"../utils\";\nimport CollectionListing from \"./CollectionListing\";\nimport Text from \"./Text\";\n\nconst shouldSearchCollectionsByName = (query: string | null): boolean => {\n  if (query == null || query.length === 0) {\n    return false;\n  }\n  if (isAddressLike(query) || isEnsLike(query)) {\n    return false;\n  }\n  return true;\n};\n\nconst shouldSearchCollectionsByAddress = (query: string | null): boolean => {\n  if (query == null || query.length === 0) {\n    return false;\n  }\n  return isAddressLike(query);\n};\n\ninterface CollectionFetcherProps {\n  submitted: string | null;\n  onChangeSelectedCollection: (collection: Collection | null) => void;\n}\n\nexport default function CollectionFetcher(\n  props: CollectionFetcherProps\n): JSX.Element {\n  const {\n    loading: queriedCollectionsLoading,\n    error: queriedCollectionsError,\n    data: queriedCollections,\n  } = useFetchCollectionsByAddress(\n    props.submitted,\n    shouldSearchCollectionsByAddress(props.submitted)\n  );\n  const {\n    loading: searchedCollectionsLoading,\n    error: searchedCollectionsError,\n    data: searchedCollections,\n  } = useFetchCollectionsByName(\n    props.submitted,\n    shouldSearchCollectionsByName(props.submitted)\n  );\n  const collections =\n    queriedCollections.length > 0 ? queriedCollections : searchedCollections;\n  return (\n    <View>\n      {queriedCollectionsLoading || searchedCollectionsLoading ? (\n        <Text style={{ fontSize: 18, marginTop: 20 }}>\n          ❀ ❀ ❀ searching collections ❀ ❀ ❀\n        </Text>\n      ) : queriedCollectionsError || searchedCollectionsError ? (\n        <Text style={{ fontSize: 18, marginTop: 20 }}>\n          we encountered an error :{\"(\"}\n        </Text>\n      ) : (\n        collections &&\n        collections.length > 0 && (\n          <View style={{ width: \"100%\", alignItems: \"center\" }}>\n            <Text style={{ fontSize: 24, padding: 8 }}>collections</Text>\n            <CollectionListing\n              collections={collections}\n              onChangeCollection={props.onChangeSelectedCollection}\n            />\n          </View>\n        )\n      )}\n    </View>\n  );\n}\n","import { ApolloError, gql, useQuery } from \"@apollo/client\";\nimport { Collection } from \"../models/collection\";\n\nexport const CollectionsQuery: string = `\n    query FindCollection($collectionAddresses: [String!]!) {\n      collections(pagination: {limit: 50}, where: {collectionAddresses: $collectionAddresses}) {\n        nodes {\n          address\n          description\n          name\n        }\n      }\n    }\n`;\n\nexport function useFetchCollectionsByAddress(\n  query: string | null,\n  shouldPerformQuery: boolean\n): { loading: boolean; error?: ApolloError; data: Array<Collection> } {\n  const { loading, error, data } = useQuery(gql(CollectionsQuery), {\n    variables: {\n      collectionAddresses: [query],\n    },\n    skip: !shouldPerformQuery,\n  });\n\n  return {\n    loading,\n    error,\n    data:\n      data == null\n        ? []\n        : data.collections.nodes.map((res: any) => ({\n            collectionAddress: res.address,\n            description: res.description,\n            name: res.name,\n          })),\n  };\n}\n","import { ApolloError, gql, useQuery } from \"@apollo/client\";\nimport { Collection } from \"../models/collection\";\n\nexport const CollectionSearchQuery: string = `\n    query Search($query: String!) {\n      search(pagination: {limit: 50}, query: {text: $query}, filter: {entityType: COLLECTION}) {\n        nodes {\n          collectionAddress\n          description\n          name\n        }\n      }\n    }\n`;\n\nexport function useFetchCollectionsByName(\n  query: string | null,\n  shouldPerformQuery: boolean\n): { loading: boolean; error?: ApolloError; data: Array<Collection> } {\n  const { loading, error, data } = useQuery(gql(CollectionSearchQuery), {\n    variables: {\n      query: query,\n    },\n    skip: !shouldPerformQuery,\n  });\n\n  return {\n    loading,\n    error,\n    data:\n      data == null\n        ? []\n        : data.search.nodes.map((res: any) => ({\n            collectionAddress: res.collectionAddress,\n            description: res.description,\n            name: res.name,\n          })),\n  };\n}\n","import React, { useState } from \"react\";\nimport {\n  Keyboard,\n  StyleSheet,\n  TextInput,\n  TouchableOpacity,\n  View,\n} from \"react-native\";\nimport { Feather } from \"@expo/vector-icons\";\nimport Text from \"./Text\";\n\ninterface SearchInputProps {\n  text: string | null;\n  submitted: string | null;\n  onChangeText: (query: string | null) => void;\n  onChangeSubmittedText: (text: string | null) => void;\n  placeholderText?: string;\n}\n\nexport default function SearchInput(props: SearchInputProps): JSX.Element {\n  return (\n    <View style={styles.container}>\n      <View\n        style={[\n          styles.searchInputBackground,\n          { width: props.submitted != null ? \"85%\" : \"100%\" },\n        ]}\n      >\n        <View style={{ width: \"100%\", flexDirection: \"row\", flex: 1 }}>\n          <Feather\n            name=\"search\"\n            size={20}\n            color=\"black\"\n            style={{ marginLeft: 6 }}\n          />\n          <TextInput\n            style={styles.textInput}\n            autoCorrect={false}\n            autoComplete=\"off\"\n            autoCapitalize=\"none\"\n            placeholder={props.placeholderText}\n            returnKeyType=\"search\"\n            onSubmitEditing={() => props.onChangeSubmittedText(props.text)}\n            value={props.text ?? \"\"}\n            onChangeText={props.onChangeText}\n          />\n        </View>\n        {props.text != null && props.text.length > 0 && (\n          <TouchableOpacity\n            onPress={() => props.onChangeText(null)}\n            style={{ paddingRight: 6, paddingLeft: 6 }}\n          >\n            <Text style={{ fontSize: 18 }}>✕</Text>\n          </TouchableOpacity>\n        )}\n      </View>\n      {props.submitted != null && (\n        <TouchableOpacity\n          onPress={() => {\n            props.onChangeText(null);\n            props.onChangeSubmittedText(null);\n            Keyboard.dismiss();\n          }}\n          style={styles.cancelButton}\n        >\n          <Text style={{ padding: 8 }}>Cancel</Text>\n        </TouchableOpacity>\n      )}\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    margin: 15,\n    alignItems: \"center\",\n    flexDirection: \"row\",\n  },\n  searchInputBackground: {\n    padding: 10,\n    flexDirection: \"row\",\n    backgroundColor: \"#5c5c5c\",\n    borderRadius: 15,\n    alignItems: \"center\",\n  },\n  textInput: {\n    fontSize: 20,\n    marginLeft: 10,\n    flex: 1,\n    color: \"white\",\n  },\n  cancelButton: {\n    marginLeft: 12,\n    borderWidth: 1,\n    borderColor: \"white\",\n    borderRadius: 6,\n  },\n});\n","import { ApolloError, gql, useQuery } from \"@apollo/client\";\nimport { Collection } from \"../models/collection\";\nimport { Token } from \"../models/token\";\n\nexport const TokenFragment = gql`\n  fragment TokenFragment on Token {\n    collectionAddress\n    tokenId\n    name\n    collectionName\n    owner\n    description\n    content {\n      mediaEncoding {\n        ... on AudioEncodingTypes {\n          original\n        }\n      }\n    }\n    image {\n      mediaEncoding {\n        ... on ImageEncodingTypes {\n          thumbnail\n        }\n      }\n    }\n    metadata\n  }\n`;\n\nexport const MusicNFTSearchQuery = gql`\n  query MusicNFTs(\n    $collectionAddresses: [String!]\n    $ownerAddresses: [String!]\n    $sort: TokenSortInput\n    $limit: Int!\n  ) {\n    tokens(\n      pagination: { limit: $limit }\n      sort: $sort\n      where: {\n        collectionAddresses: $collectionAddresses\n        ownerAddresses: $ownerAddresses\n      }\n      filter: { mediaType: AUDIO }\n    ) {\n      nodes {\n        token {\n          ...TokenFragment\n        }\n      }\n    }\n  }\n  ${TokenFragment}\n`;\n\nexport function useFetchMusicNfts(\n  collection?: Collection,\n  ownerAddress?: string,\n  sort?: { [key: string]: string },\n  limit?: number\n): { loading: boolean; error?: ApolloError; data: Array<Token> } {\n  const collectionAddresses =\n    collection == null ? undefined : [collection.collectionAddress];\n  const ownerAddresses = ownerAddress == null ? undefined : [ownerAddress];\n  const { loading, error, data } = useQuery(MusicNFTSearchQuery, {\n    variables: {\n      collectionAddresses: collectionAddresses,\n      ownerAddresses: ownerAddresses,\n      limit: limit ?? 500,\n      sort: sort,\n    },\n    skip: collection == null && ownerAddress == null,\n  });\n\n  return {\n    loading,\n    error,\n    data:\n      data == null\n        ? []\n        : data.tokens.nodes.map((res: any): Token => {\n            const token = res.token;\n            return {\n              collectionAddress: token.collectionAddress,\n              tokenId: token.tokenId,\n              name: token.name,\n              collectionName: token.collectionName,\n              owner: token.owner,\n              description: token.description,\n              audioUri: token.content.mediaEncoding.original,\n              imageUri: token.image.mediaEncoding.thumbnail,\n              metadata: token.metadata,\n            };\n          }),\n  };\n}\n","import { useEffect, useState } from \"react\";\nimport { StyleSheet, TouchableOpacity } from \"react-native\";\nimport { Token } from \"../models/token\";\nimport SongListing from \"./SongListing\";\nimport Text from \"./Text\";\n\ninterface SongPaginatorProps {\n  songs: Array<Token>;\n  onChangeCurrentSong: (song: Token) => void;\n  addToUserQueue: (song: Token) => void;\n  isLoading: boolean;\n  offset: number;\n  setOffset: (setOffsetFn: (offset: number) => number) => void;\n}\n\nexport default function SongPaginator(props: SongPaginatorProps): JSX.Element {\n  const limit = 10;\n  const [currentPage, setCurrentPage] = useState<Array<Token>>([]);\n\n  useEffect(() => {\n    setCurrentPage(props.songs.slice(0, props.offset + limit));\n  }, [props.offset, props.songs]);\n\n  return (\n    <SongListing\n      onChangeCurrentSong={(songIdx: number) =>\n        props.onChangeCurrentSong(currentPage[songIdx])\n      }\n      addToUserQueue={(songIdx: number) =>\n        props.addToUserQueue(currentPage[songIdx])\n      }\n      isLoading={props.isLoading}\n      loadMoreButton={\n        <TouchableOpacity\n          style={styles.loadMoreButton}\n          onPress={() => props.setOffset((curOffset) => curOffset + limit)}\n        >\n          <Text style={styles.loadMoreText}>load more</Text>\n        </TouchableOpacity>\n      }\n      hasNextPage={props.songs.length > currentPage.length}\n      songs={currentPage}\n    />\n  );\n}\n\nconst styles = StyleSheet.create({\n  loadMoreButton: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    marginBottom: 20,\n  },\n  loadMoreText: {\n    fontSize: 16,\n    padding: 8,\n    borderWidth: 1,\n    borderColor: \"white\",\n    borderRadius: 6,\n  },\n});\n","import { SafeAreaView, View } from \"react-native\";\nimport { useFetchMusicNfts } from \"../hooks/useFetchMusicNfts\";\nimport { Collection } from \"../models/collection\";\nimport { Token } from \"../models/token\";\nimport SongPaginator from \"./SongPaginator\";\nimport Text from \"./Text\";\n\ninterface SongFetcherProps {\n  onChangeSelectedSong: (song: Token | null) => Promise<boolean>;\n  addToUserQueue: (song: Token) => void;\n  handleChangeGlobalQueue: (songs: Array<Token>) => void;\n  isLoading: boolean;\n  offset: number;\n  setOffset: (setOffsetFn: (offset: number) => number) => void;\n  collection?: Collection;\n  ownerAddress?: string;\n}\n\nconst GLOBAL_QUEUE_SIZE = 25;\n\nexport default function SongFetcher(props: SongFetcherProps): JSX.Element {\n  const {\n    loading,\n    error,\n    data: musicNfts,\n  } = useFetchMusicNfts(props.collection, props.ownerAddress);\n\n  const handleChangeCurrentSong = async (song: Token) => {\n    const didSetSong = await props.onChangeSelectedSong(song);\n    if (didSetSong && musicNfts.length > 0) {\n      const startIdx = musicNfts.indexOf(song) + 1;\n      const nextSongs = musicNfts.slice(startIdx, startIdx + GLOBAL_QUEUE_SIZE);\n      let prevSongs = [];\n      const endIdx = Math.min(\n        GLOBAL_QUEUE_SIZE - nextSongs.length,\n        startIdx - 1\n      );\n      if (GLOBAL_QUEUE_SIZE > nextSongs.length) {\n        for (let i = 0; i < endIdx; i++) {\n          const song = musicNfts[i];\n          if (!nextSongs.includes(song)) {\n            prevSongs.push(song);\n          }\n        }\n      }\n      props.handleChangeGlobalQueue([...nextSongs, ...prevSongs]);\n    }\n  };\n\n  const searchLoadingText =\n    props.ownerAddress == null\n      ? \"❀ ❀ ❀ searching music ❀ ❀ ❀\"\n      : \"❀ ❀ ❀ searching owners ❀ ❀ ❀\";\n\n  const noneFoundText =\n    props.ownerAddress == null\n      ? \"no music found :(\"\n      : `no music owned by ${props.ownerAddress}`;\n\n  return (\n    <SafeAreaView\n      style={{\n        flex: 1,\n        width: \"100%\",\n      }}\n    >\n      {loading ? (\n        <View style={{ width: \"100%\", alignItems: \"center\" }}>\n          <Text style={{ fontSize: 18, marginTop: 20 }}>\n            {searchLoadingText}\n          </Text>\n        </View>\n      ) : error ? (\n        <View style={{ width: \"100%\", alignItems: \"center\" }}>\n          <Text style={{ fontSize: 18, marginTop: 20 }}>\n            we encountered an error :{\"(\"}\n          </Text>\n        </View>\n      ) : musicNfts.length > 0 ? (\n        <SongPaginator\n          songs={musicNfts}\n          onChangeCurrentSong={handleChangeCurrentSong}\n          addToUserQueue={props.addToUserQueue}\n          isLoading={props.isLoading}\n          offset={props.offset}\n          setOffset={props.setOffset}\n        />\n      ) : (\n        <View style={{ width: \"100%\", alignItems: \"center\" }}>\n          <Text style={{ fontSize: 16, marginTop: 20 }}>{noneFoundText}</Text>\n        </View>\n      )}\n    </SafeAreaView>\n  );\n}\n","import { SafeAreaView, StyleSheet, View } from \"react-native\";\nimport { useFetchMusicNfts } from \"../hooks/useFetchMusicNfts\";\nimport { Token } from \"../models/token\";\nimport SongListing from \"./SongListing\";\nimport Text from \"./Text\";\n\nexport default function WelcomeMessage(props: {\n  addToUserQueue: (song: Token) => void;\n  onChangeCurrentSong: (song: Token | null) => void;\n  isLoading: boolean;\n}): JSX.Element {\n  const {\n    loading,\n    error,\n    data: musicNfts,\n  } = useFetchMusicNfts(\n    { collectionAddress: \"0xabEFBc9fD2F806065b4f3C237d4b59D9A97Bcac7\" },\n    undefined,\n    { sortKey: \"MINTED\", sortDirection: \"DESC\" },\n    10\n  );\n  const songs = loading || error ? [] : musicNfts;\n  return (\n    <View style={{ width: \"100%\", flex: 1 }}>\n      <View style={{ width: \"100%\", alignItems: \"center\" }}>\n        <View style={{ width: \"80%\", alignItems: \"center\", marginTop: 18 }}>\n          <Text style={{ fontSize: 24, marginBottom: 18 }}>\n            welcome to onchain.fm\n          </Text>\n          <View style={{ alignItems: \"flex-start\" }}>\n            <Text style={{ fontSize: 16, marginBottom: 12 }}>\n              ❀ search for a collection by name or address\n            </Text>\n            <Text style={{ fontSize: 16 }}>\n              ❀ search for an owner by ens or address\n            </Text>\n          </View>\n        </View>\n      </View>\n      <SafeAreaView style={styles.safeAreaView}>\n        <View style={{ width: \"100%\", alignItems: \"center\" }}>\n          <Text style={{ fontSize: 18, padding: 8 }}>\n            recently minted on zora\n          </Text>\n        </View>\n        <SongListing\n          songs={songs}\n          onChangeCurrentSong={(songIdx: number) =>\n            props.onChangeCurrentSong(songs[songIdx])\n          }\n          addToUserQueue={(songIdx: number) =>\n            props.addToUserQueue(songs[songIdx])\n          }\n          isLoading={props.isLoading}\n        />\n      </SafeAreaView>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  safeAreaView: {\n    flex: 1,\n    marginTop: 32,\n    width: \"100%\",\n  },\n});\n","import { StyleSheet, View } from \"react-native\";\nimport CollectionFetcher from \"../components/CollectionFetcher\";\nimport SearchInput from \"../components/SearchInput\";\nimport SongFetcher from \"../components/SongFetcher\";\nimport WelcomeMessage from \"../components/WelcomeMessage\";\nimport { PlayerState } from \"../hooks/usePlayer\";\nimport { QueueState } from \"../hooks/useQueue\";\nimport { SearchState } from \"../hooks/useSearch\";\nimport { Collection } from \"../models/collection\";\nimport { isAddressLike, isEnsLike } from \"../utils\";\n\nconst shouldQueryByOwner = (\n  query: string | null,\n  selectedCollection: Collection | null\n): boolean => {\n  if (query == null || query.length === 0) {\n    return false;\n  }\n  if (selectedCollection != null) {\n    return false;\n  }\n  return isEnsLike(query) || isAddressLike(query);\n};\n\ninterface SearchViewProps {\n  searchState: SearchState;\n  playerState: PlayerState;\n  queueState: QueueState;\n}\n\nexport default function SearchView(props: SearchViewProps): JSX.Element {\n  const {\n    query,\n    onChangeQuery,\n    submitted,\n    onChangeSubmitted,\n    selectedCollection,\n    setSelectedCollection,\n    offset,\n    setOffset,\n  } = props.searchState;\n\n  const owner = shouldQueryByOwner(submitted, selectedCollection)\n    ? submitted\n    : undefined;\n\n  return (\n    <View style={styles.container}>\n      <View style={styles.searchInputContainer}>\n        <View style={{ width: \"100%\" }}>\n          <SearchInput\n            text={query}\n            submitted={submitted}\n            onChangeText={onChangeQuery}\n            onChangeSubmittedText={onChangeSubmitted}\n          />\n        </View>\n      </View>\n      <View style={styles.fetcherContainer}>\n        {submitted == null && (\n          <WelcomeMessage\n            onChangeCurrentSong={props.playerState.handleSetCurrentSong}\n            addToUserQueue={props.queueState.addToUserQueue}\n            isLoading={props.playerState.isLoading}\n          />\n        )}\n        {selectedCollection == null && submitted != null && (\n          <CollectionFetcher\n            submitted={submitted}\n            onChangeSelectedCollection={setSelectedCollection}\n          />\n        )}\n        {(selectedCollection != null || owner != null) && submitted != null && (\n          <SongFetcher\n            collection={selectedCollection ?? undefined}\n            ownerAddress={owner ?? undefined}\n            onChangeSelectedSong={props.playerState.handleSetCurrentSong}\n            addToUserQueue={props.queueState.addToUserQueue}\n            handleChangeGlobalQueue={props.queueState.setGlobalQueue}\n            isLoading={props.playerState.isLoading}\n            offset={offset}\n            setOffset={setOffset}\n          />\n        )}\n      </View>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    width: \"100%\",\n    alignItems: \"center\",\n    flex: 1,\n    height: \"100%\",\n    marginTop: 20,\n  },\n  searchInputContainer: {\n    flexDirection: \"row\",\n    alignItems: \"center\",\n    justifyContent: \"center\",\n    width: \"80%\",\n  },\n  fetcherContainer: {\n    flex: 1,\n    width: \"100%\",\n    alignItems: \"center\",\n  },\n});\n","import imageLoading from \"../assets/image-loading.png\";\nimport { Token } from \"../models/token\";\nimport {\n  Image,\n  SafeAreaView,\n  ScrollView,\n  StyleSheet,\n  TouchableOpacity,\n  View,\n} from \"react-native\";\nimport Text from \"../components/Text\";\nimport { useState } from \"react\";\n\ninterface SongInfoViewProps {\n  song: Token;\n  handleCloseSongInfoView: () => void;\n}\nexport default function SongInfoView(props: SongInfoViewProps): JSX.Element {\n  const song = props.song;\n  const [showMetadata, setShowMetadata] = useState(false);\n  return (\n    <View style={styles.container}>\n      <SafeAreaView style={styles.safeAreaView}>\n        <TouchableOpacity\n          onPress={() => props.handleCloseSongInfoView()}\n          style={{ marginBottom: 24, paddingLeft: 16, marginTop: 10 }}\n        >\n          <Text style={{ fontSize: 24 }}>✕</Text>\n        </TouchableOpacity>\n        <ScrollView style={{ paddingLeft: 16, paddingRight: 16 }}>\n          <View style={styles.header}>\n            <Text style={{ fontSize: 24, marginBottom: 24 }}>{song.name}</Text>\n            <Image\n              defaultSource={imageLoading}\n              source={{ uri: song?.imageUri }}\n              style={{ width: 256, height: 256, borderRadius: 10 }}\n            />\n          </View>\n          <Text style={{ fontSize: 18 }}>\n            {song.collectionName} #{song.tokenId}\n          </Text>\n          <Text style={{ marginBottom: 12 }}>{song.collectionAddress}</Text>\n          <Text style={{ marginBottom: 12 }}>Owner: {song.owner}</Text>\n          <Text style={{ marginBottom: 20 }}>{song.description}</Text>\n          <View\n            style={{\n              width: \"100%\",\n              alignItems: \"center\",\n              justifyContent: \"center\",\n            }}\n          >\n            <TouchableOpacity\n              style={styles.showMetadataButton}\n              onPress={() => setShowMetadata(!showMetadata)}\n            >\n              <Text style={styles.showMetadataText}>\n                {showMetadata ? \"hide raw metadata\" : \"show raw metadata\"}\n              </Text>\n            </TouchableOpacity>\n            {showMetadata && (\n              <Text style={{ marginBottom: 24 }}>\n                {JSON.stringify(song.metadata, null, 2)}\n              </Text>\n            )}\n          </View>\n        </ScrollView>\n      </SafeAreaView>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    width: \"100%\",\n    alignItems: \"center\",\n    flex: 1,\n    height: \"100%\",\n  },\n  safeAreaView: {\n    flex: 1,\n    width: \"100%\",\n  },\n  header: {\n    width: \"100%\",\n    alignItems: \"center\",\n    marginBottom: 20,\n  },\n  showMetadataButton: {\n    width: \"80%\",\n    maxWidth: 256,\n    alignItems: \"center\",\n    marginBottom: 36,\n    borderWidth: 1,\n    borderRadius: 10,\n    borderColor: \"white\",\n  },\n  showMetadataText: {\n    fontSize: 18,\n    lineHeight: 18,\n    paddingTop: 16,\n    paddingBottom: 16,\n  },\n});\n","import { ApolloClient, ApolloProvider, InMemoryCache } from \"@apollo/client\";\nimport { Audio, InterruptionModeIOS } from \"expo-av\";\nimport { useEffect, useState } from \"react\";\nimport { StatusBar, StyleSheet, View } from \"react-native\";\nimport { RootSiblingParent } from \"react-native-root-siblings\";\nimport Player from \"./components/Player\";\nimport { PlayerState, usePlayer } from \"./hooks/usePlayer\";\nimport useQueue, { QueueState } from \"./hooks/useQueue\";\nimport { useSearch } from \"./hooks/useSearch\";\nimport QueueView from \"./views/QueueView\";\nimport SearchView from \"./views/SearchView\";\nimport SongInfoView from \"./views/SongInfoView\";\n\nconst client = new ApolloClient({\n  uri: \"https://api.zora.co/graphql\",\n  cache: new InMemoryCache(),\n});\n\nexport default function App() {\n  const queueState: QueueState = useQueue();\n  const playerState: PlayerState = usePlayer(queueState);\n  const [isQueueViewOpen, setIsQueueViewOpen] = useState(false);\n  const [isSongInfoViewOpen, setIsSongInfoViewOpen] = useState(false);\n  const [hasSetAudioMode, setHasSetAudioMode] = useState(false);\n  const searchState = useSearch();\n  useEffect(() => {\n    const setUpSound = async () => {\n      await Audio.setAudioModeAsync({\n        staysActiveInBackground: true,\n        interruptionModeIOS: InterruptionModeIOS.DoNotMix,\n        allowsRecordingIOS: false,\n        playsInSilentModeIOS: true,\n      });\n    };\n    if (!hasSetAudioMode) {\n      setUpSound();\n      setHasSetAudioMode(true);\n    }\n  });\n  return (\n    <RootSiblingParent>\n      <ApolloProvider client={client}>\n        <View style={styles.container}>\n          <StatusBar />\n          <View style={styles.screen}>\n            <View\n              style={{\n                width: \"100%\",\n                alignItems: \"center\",\n                flex: 1,\n              }}\n            >\n              {isSongInfoViewOpen && playerState.currentLoadedSong != null && (\n                <SongInfoView\n                  song={playerState.currentLoadedSong.song}\n                  handleCloseSongInfoView={() => setIsSongInfoViewOpen(false)}\n                />\n              )}\n              {isQueueViewOpen && (\n                <QueueView\n                  queueState={queueState}\n                  playerState={playerState}\n                  handleCloseQueueView={() => setIsQueueViewOpen(false)}\n                />\n              )}\n              {!isSongInfoViewOpen && !isQueueViewOpen && (\n                <SearchView\n                  searchState={searchState}\n                  playerState={playerState}\n                  queueState={queueState}\n                />\n              )}\n            </View>\n            <View style={styles.player}>\n              <Player\n                playerState={playerState}\n                onChangeIsSongInfoViewOpen={() => {\n                  setIsSongInfoViewOpen(!isSongInfoViewOpen);\n                  setIsQueueViewOpen(false);\n                }}\n                handleToggleQueueView={() => {\n                  if (!isQueueViewOpen) {\n                    setIsQueueViewOpen(true);\n                    setIsSongInfoViewOpen(false);\n                  } else {\n                    setIsQueueViewOpen(false);\n                  }\n                }}\n              />\n            </View>\n          </View>\n        </View>\n      </ApolloProvider>\n    </RootSiblingParent>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    backgroundColor: \"#2d2d2d\",\n    alignItems: \"center\",\n    flex: 1,\n  },\n  screen: {\n    width: \"100%\",\n    alignItems: \"center\",\n    flex: 1,\n    marginTop: 20,\n  },\n  player: {\n    width: \"100%\",\n    alignItems: \"center\",\n    height: 200,\n    shadowColor: \"#171717\",\n    shadowOffset: { width: 0, height: -2 },\n    borderTopWidth: 0.5,\n    borderLeftWidth: 0.5,\n    borderRightWidth: 0.5,\n    borderTopLeftRadius: 10,\n    borderTopRightRadius: 10,\n    shadowOpacity: 0.1,\n    shadowRadius: 3,\n    backgroundColor: \"black\",\n  },\n});\n","import { useState } from \"react\";\nimport { Token } from \"../models/token\";\n\nexport interface QueueState {\n  history: Array<Token>;\n  addToHistory: (song: Token) => void;\n  popFromHistory: () => Token | null;\n  userQueue: Array<Token>;\n  addToUserQueue: (song: Token) => void;\n  removeFromUserQueue: (songIdx: number) => void;\n  popFromUserQueue: () => Token | null;\n  globalQueue: Array<Token>;\n  setGlobalQueue: (songs: Array<Token>) => void;\n  removeFromGlobalQueue: (songIdx: number) => void;\n  popFromGlobalQueue: () => Token | null;\n}\n\nexport default function useQueue(): QueueState {\n  const [history, setHistory] = useState<Array<Token>>([]);\n  const [userQueue, setUserQueue] = useState<Array<Token>>([]);\n  const [globalQueue, setGlobalQueue] = useState<Array<Token>>([]);\n\n  // History\n  const addToHistory = (song: Token) => {\n    setHistory((curHistory: Array<Token>) => [...curHistory, song]);\n  };\n\n  const popFromHistory = (): Token | null => {\n    if (history.length > 0) {\n      const song = history[history.length - 1];\n      if (song != null) {\n        setHistory((curHistory) => [...curHistory.slice(0, -1)]);\n        return song;\n      }\n    }\n    return null;\n  };\n\n  // User Queue\n  const addToUserQueue = (song: Token) => {\n    setUserQueue((curUserQueue) => [...curUserQueue, song]);\n  };\n  const removeFromUserQueue = (songIdx: number) => {\n    setUserQueue((curUserQueue) =>\n      curUserQueue.filter((s, idx) => idx != songIdx)\n    );\n  };\n  const popFromUserQueue = (): Token | null => {\n    if (userQueue.length > 0) {\n      const song = userQueue[0];\n      setUserQueue((curUserQueue) => [...curUserQueue.slice(1)]);\n      return song;\n    }\n    return null;\n  };\n\n  // Global Queue\n  const removeFromGlobalQueue = (songIdx: number) => {\n    setGlobalQueue((curGlobalQueue) =>\n      curGlobalQueue.filter((s, idx) => idx != songIdx)\n    );\n  };\n  const popFromGlobalQueue = (): Token | null => {\n    if (globalQueue.length > 0) {\n      const song = globalQueue[0];\n      setGlobalQueue((curGlobalQueue) => [...curGlobalQueue.slice(1)]);\n      return song;\n    }\n    return null;\n  };\n\n  return {\n    history,\n    addToHistory,\n    popFromHistory,\n    userQueue,\n    addToUserQueue,\n    removeFromUserQueue,\n    popFromUserQueue,\n    globalQueue,\n    setGlobalQueue,\n    removeFromGlobalQueue,\n    popFromGlobalQueue,\n  };\n}\n","import { useState } from \"react\";\nimport { Collection } from \"../models/collection\";\nimport { normalizeText } from \"../utils\";\n\nexport interface SearchState {\n  query: string | null;\n  onChangeQuery: (query: string | null) => void;\n  submitted: string | null;\n  onChangeSubmitted: (result: string | null) => void;\n  selectedCollection: Collection | null;\n  setSelectedCollection: (collection: Collection | null) => void;\n  offset: number;\n  setOffset: (setOffsetFn: (offset: number) => number) => void;\n}\n\nexport function useSearch(): SearchState {\n  const [query, setQuery] = useState<string | null>(null);\n  const [submitted, setSubmitted] = useState<string | null>(null);\n  const [offset, setOffset] = useState(0);\n  const [selectedCollection, setSelectedCollection] =\n    useState<Collection | null>(null);\n\n  return {\n    query: query,\n    onChangeQuery: (query: string | null) => setQuery(query),\n    submitted: submitted,\n    onChangeSubmitted: (submitted: string | null) => {\n      setSelectedCollection(null);\n      setOffset(0);\n      if (submitted != null) {\n        setSubmitted(normalizeText(submitted));\n      } else {\n        setSubmitted(null);\n      }\n    },\n    selectedCollection,\n    setSelectedCollection,\n    offset,\n    setOffset,\n  };\n}\n"],"sourceRoot":""}